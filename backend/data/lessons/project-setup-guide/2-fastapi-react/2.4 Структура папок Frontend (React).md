# 2.4 Структура папок Frontend (React)

#### 🎯 Зачем нужна правильная структура

**Проблема плоской структуры:**
- Все компоненты в одной папке (20+ файлов в src/)
- Непонятно что переиспользуется, а что специфично для страницы
- API calls разбросаны по компонентам
- Стили дублируются
- ИИ путается где что создавать

**Правильная структура даёт:**
- ✅ Понятно где искать компоненты (UI, features, pages)
- ✅ Легко переиспользовать (shared компоненты)
- ✅ API logic изолирована (services/)
- ✅ Легко добавлять фичи (знаешь куда класть)
- ✅ ИИ понимает структуру

---

#### 📐 Структура Frontend проекта (React + Vite)

```
frontend/
│
├── public/                        # 🌐 СТАТИЧНЫЕ ФАЙЛЫ
│   ├── vite.svg                  • Не обрабатываются Vite
│   └── favicon.ico               • Доступны по /filename
│                                  ЗАЧЕМ: картинки, шрифты, манифест
│
├── src/                           # 📦 ИСХОДНИКИ
│   │
│   ├── components/                # 🧩 ПЕРЕИСПОЛЬЗУЕМЫЕ КОМПОНЕНТЫ
│   │   ├── ui/                   
│   │   │   ├── Button.jsx        • Базовые UI элементы
│   │   │   ├── Input.jsx         • Используются везде
│   │   │   ├── Card.jsx          ЗАЧЕМ: единый дизайн
│   │   │   └── Modal.jsx         
│   │   │
│   │   └── features/             
│   │       ├── CamForm/          • Бизнес-компоненты
│   │       │   ├── CamForm.jsx   • Форма ввода кулачка
│   │       │   └── CamForm.css   ЗАЧЕМ: группировка по фиче
│   │       │
│   │       └── CamChart/         
│   │           ├── CamChart.jsx  • График профиля
│   │           └── CamChart.css  
│   │
│   ├── pages/                     # 📄 СТРАНИЦЫ
│   │   ├── HomePage.jsx          • Главная страница
│   │   ├── CamsPage.jsx          • Страница со списком
│   │   ├── CamDetailPage.jsx    • Детали кулачка
│   │   └── NotFoundPage.jsx     • 404
│   │                              ЗАЧЕМ: routes React Router
│   │
│   ├── services/                  # 🔌 API CALLS
│   │   ├── api.js                • Axios instance с baseURL
│   │   ├── camService.js         • API для кулачков
│   │   │                          • getCams(), createCam()
│   │   └── authService.js        • API для auth (если нужно)
│   │                              ЗАЧЕМ: изоляция API логики
│   │
│   ├── hooks/                     # 🎣 CUSTOM HOOKS (опционально)
│   │   ├── useCams.js            • Hook для получения кулачков
│   │   └── useDebounce.js        • Переиспользуемая логика
│   │                              ЗАЧЕМ: DRY для React hooks
│   │
│   ├── utils/                     # 🔧 УТИЛИТЫ
│   │   ├── formatters.js         • Форматирование дат, чисел
│   │   └── validators.js         • Валидация форм
│   │                              ЗАЧЕМ: общие функции
│   │
│   ├── styles/                    # 🎨 ГЛОБАЛЬНЫЕ СТИЛИ
│   │   └── index.css             • TailwindCSS imports
│   │                              • Глобальные стили
│   │
│   ├── App.jsx                    # 🚀 ГЛАВНЫЙ КОМПОНЕНТ
│   │                              • React Router setup
│   │                              • Layout
│   │
│   ├── main.jsx                   # 📍 ТОЧКА ВХОДА
│   │                              • ReactDOM.render()
│   │                              • Providers
│   │
│   └── vite-env.d.ts             # TypeScript types (если TS)
│
├── index.html                     # HTML ШАБЛОН
├── package.json                   # Зависимости
├── vite.config.js                # Vite конфигурация
├── .env                          # Переменные (в .gitignore)
├── .env.example                  # Шаблон переменных
├── .gitignore                    # Git исключения
└── README.md                     # Документация
```

---

#### 💡 Детально про каждую папку

**src/components/ - Переиспользуемые компоненты**

**Разделение:**
- `components/ui/` - Базовые UI элементы (кнопки, инпуты, карточки)
- `components/features/` - Бизнес-компоненты (форма кулачка, график)

**components/ui/ - Базовые UI**

Компоненты которые используются ВЕЗДЕ в приложении.

**Пример: components/ui/Button.jsx**
```jsx
export default function Button({ 
  children, 
  variant = 'primary', 
  onClick, 
  disabled = false 
}) {
  const baseStyles = "px-4 py-2 rounded-lg font-medium transition"
  const variants = {
    primary: "bg-blue-600 text-white hover:bg-blue-700",
    secondary: "bg-gray-200 text-gray-800 hover:bg-gray-300",
    danger: "bg-red-600 text-white hover:bg-red-700"
  }
  
  return (
    <button
      className={`${baseStyles} ${variants[variant]}`}
      onClick={onClick}
      disabled={disabled}
    >
      {children}
    </button>
  )
}
```

**Когда создавать UI компонент:**
- Используется в 3+ местах
- Базовый элемент (кнопка, инпут, карточка)
- Не содержит бизнес-логику

**Размер:** ~50-100 строк на компонент

---

**components/features/ - Бизнес-компоненты**

Компоненты связанные с конкретной фичей/доменом.

**Пример: components/features/CamForm/CamForm.jsx**
```jsx
import { useState } from 'react'
import Button from '../../ui/Button'
import Input from '../../ui/Input'
import { createCam } from '../../../services/camService'

export default function CamForm({ onSuccess }) {
  const [formData, setFormData] = useState({
    base_radius: '',
    lift: '',
    duration: ''
  })
  const [loading, setLoading] = useState(false)
  const [error, setError] = useState(null)
  
  const handleSubmit = async (e) => {
    e.preventDefault()
    setLoading(true)
    setError(null)
    
    try {
      const cam = await createCam(formData)
      onSuccess(cam)
      setFormData({ base_radius: '', lift: '', duration: '' })
    } catch (err) {
      setError(err.message)
    } finally {
      setLoading(false)
    }
  }
  
  return (
    <form onSubmit={handleSubmit} className="space-y-4">
      <Input
        label="Base Radius (mm)"
        type="number"
        value={formData.base_radius}
        onChange={(e) => setFormData({...formData, base_radius: e.target.value})}
        required
      />
      
      <Input
        label="Lift (mm)"
        type="number"
        value={formData.lift}
        onChange={(e) => setFormData({...formData, lift: e.target.value})}
        required
      />
      
      <Input
        label="Duration (degrees)"
        type="number"
        value={formData.duration}
        onChange={(e) => setFormData({...formData, duration: e.target.value})}
        min="0"
        max="360"
        required
      />
      
      {error && <p className="text-red-600">{error}</p>}
      
      <Button type="submit" disabled={loading}>
        {loading ? 'Creating...' : 'Create Cam'}
      </Button>
    </form>
  )
}
```

**Когда создавать feature компонент:**
- Связан с конкретной бизнес-фичей
- Использует API calls
- Имеет сложную логику

**Структура папки фичи:**
```
components/features/CamForm/
├── CamForm.jsx           # Главный компонент
├── CamForm.css          # Стили (если нужны кастомные)
└── CamFormFields.jsx    # Подкомпоненты (опционально)
```

---

**src/pages/ - Страницы приложения**

Каждая страница = один route в React Router.

**Пример: pages/CamsPage.jsx**
```jsx
import { useState, useEffect } from 'react'
import { getCams } from '../services/camService'
import CamForm from '../components/features/CamForm/CamForm'
import Card from '../components/ui/Card'

export default function CamsPage() {
  const [cams, setCams] = useState([])
  const [loading, setLoading] = useState(true)
  
  useEffect(() => {
    loadCams()
  }, [])
  
  const loadCams = async () => {
    try {
      const data = await getCams()
      setCams(data)
    } catch (error) {
      console.error('Failed to load cams:', error)
    } finally {
      setLoading(false)
    }
  }
  
  const handleCamCreated = (newCam) => {
    setCams([...cams, newCam])
  }
  
  return (
    <div className="container mx-auto p-4">
      <h1 className="text-3xl font-bold mb-8">Cams</h1>
      
      <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
        <div>
          <h2 className="text-xl font-semibold mb-4">Create New Cam</h2>
          <CamForm onSuccess={handleCamCreated} />
        </div>
        
        <div>
          <h2 className="text-xl font-semibold mb-4">Your Cams</h2>
          {loading ? (
            <p>Loading...</p>
          ) : (
            <div className="space-y-4">
              {cams.map(cam => (
                <Card key={cam.id}>
                  <p>Radius: {cam.base_radius}mm</p>
                  <p>Lift: {cam.lift}mm</p>
                </Card>
              ))}
            </div>
          )}
        </div>
      </div>
    </div>
  )
}
```

**Размер страницы:** ~100-300 строк

**Когда страница становится слишком большой:**
- Выноси логику в custom hooks (`hooks/useCams.js`)
- Выноси части UI в feature компоненты

---

**src/services/ - API calls**

Вся логика работы с backend API в одном месте.

**Пример: services/api.js (базовый клиент)**
```javascript
import axios from 'axios'

const api = axios.create({
  baseURL: import.meta.env.VITE_API_URL || 'http://localhost:8000',
  headers: {
    'Content-Type': 'application/json'
  }
})

// Interceptor для добавления токена (если нужен)
api.interceptors.request.use((config) => {
  const token = localStorage.getItem('token')
  if (token) {
    config.headers.Authorization = `Bearer ${token}`
  }
  return config
})

// Interceptor для обработки ошибок
api.interceptors.response.use(
  (response) => response,
  (error) => {
    if (error.response?.status === 401) {
      // Redirect to login
      window.location.href = '/login'
    }
    return Promise.reject(error)
  }
)

export default api
```

**Пример: services/camService.js**
```javascript
import api from './api'

export const getCams = async () => {
  const response = await api.get('/api/cams')
  return response.data
}

export const getCam = async (id) => {
  const response = await api.get(`/api/cams/${id}`)
  return response.data
}

export const createCam = async (camData) => {
  const response = await api.post('/api/cams', camData)
  return response.data
}

export const updateCam = async (id, camData) => {
  const response = await api.put(`/api/cams/${id}`, camData)
  return response.data
}

export const deleteCam = async (id) => {
  await api.delete(`/api/cams/${id}`)
}

export const calculateProfile = async (camId) => {
  const response = await api.post(`/api/cams/${camId}/calculate`)
  return response.data
}
```

**Зачем отдельный services/:**
- ✅ API логика в одном месте
- ✅ Легко менять endpoint
- ✅ Легко тестировать
- ✅ Компоненты не знают про axios/fetch

---

**src/hooks/ - Custom hooks (опционально)**

Переиспользуемая React логика.

**Пример: hooks/useCams.js**
```javascript
import { useState, useEffect } from 'react'
import { getCams } from '../services/camService'

export default function useCams() {
  const [cams, setCams] = useState([])
  const [loading, setLoading] = useState(true)
  const [error, setError] = useState(null)
  
  useEffect(() => {
    loadCams()
  }, [])
  
  const loadCams = async () => {
    try {
      setLoading(true)
      const data = await getCams()
      setCams(data)
      setError(null)
    } catch (err) {
      setError(err.message)
    } finally {
      setLoading(false)
    }
  }
  
  const refetch = () => {
    loadCams()
  }
  
  return { cams, loading, error, refetch }
}
```

**Использование:**
```javascript
// В компоненте
function CamsPage() {
  const { cams, loading, error, refetch } = useCams()
  
  if (loading) return <p>Loading...</p>
  if (error) return <p>Error: {error}</p>
  
  return <div>{/* Render cams */}</div>
}
```

**Когда создавать custom hook:**
- Логика используется в 2+ компонентах
- Сложная логика со state и effects
- Нужно переиспользовать

---

**src/utils/ - Утилиты**

Общие функции без React зависимостей.

**Пример: utils/formatters.js**
```javascript
export const formatDate = (date) => {
  return new Date(date).toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  })
}

export const formatNumber = (num, decimals = 2) => {
  return Number(num).toFixed(decimals)
}

export const formatCurrency = (amount) => {
  return new Intl.NumberFormat('en-US', {
    style: 'currency',
    currency: 'USD'
  }).format(amount)
}
```

**Пример: utils/validators.js**
```javascript
export const isValidEmail = (email) => {
  const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/
  return regex.test(email)
}

export const isPositiveNumber = (value) => {
  const num = Number(value)
  return !isNaN(num) && num > 0
}

export const validateCamParams = (params) => {
  const errors = {}
  
  if (!isPositiveNumber(params.base_radius)) {
    errors.base_radius = 'Must be a positive number'
  }
  
  if (!isPositiveNumber(params.lift)) {
    errors.lift = 'Must be a positive number'
  }
  
  return errors
}
```

---

**src/App.jsx - Главный компонент**

Setup роутинга и layout.

**Пример:**
```jsx
import { BrowserRouter, Routes, Route } from 'react-router-dom'
import HomePage from './pages/HomePage'
import CamsPage from './pages/CamsPage'
import CamDetailPage from './pages/CamDetailPage'
import NotFoundPage from './pages/NotFoundPage'
import Navbar from './components/ui/Navbar'

export default function App() {
  return (
    <BrowserRouter>
      <div className="min-h-screen bg-gray-50">
        <Navbar />
        
        <main className="container mx-auto px-4 py-8">
          <Routes>
            <Route path="/" element={<HomePage />} />
            <Route path="/cams" element={<CamsPage />} />
            <Route path="/cams/:id" element={<CamDetailPage />} />
            <Route path="*" element={<NotFoundPage />} />
          </Routes>
        </main>
      </div>
    </BrowserRouter>
  )
}
```

---

#### ✅ Чек-лист правильной структуры

**Папки созданы:**
- [ ] src/components/ui/ (базовые UI)
- [ ] src/components/features/ (бизнес-компоненты)
- [ ] src/pages/ (страницы = routes)
- [ ] src/services/ (API calls)
- [ ] src/hooks/ (опционально, custom hooks)
- [ ] src/utils/ (общие функции)

**Разделение ответственности:**
- [ ] UI компоненты переиспользуются
- [ ] Feature компоненты изолированы
- [ ] API calls только в services/
- [ ] Страницы используют компоненты и services
- [ ] Нет API calls в компонентах (используют services)

**Именование:**
- [ ] Компоненты: PascalCase (Button.jsx, CamForm.jsx)
- [ ] Services: camelCase (camService.js)
- [ ] Utils: camelCase (formatters.js)

**Проверка:**
- [ ] Понятно где искать компонент
- [ ] Легко добавить новую страницу
- [ ] ИИ понимает структуру

---

#### 🤖 Диалог с Claude Code

**✅ Хороший диалог:**
```
Ты: Создай структуру папок для React frontend.

СТРУКТУРА:
src/
├── components/
│   ├── ui/              # Базовые UI (Button, Input, Card)
│   └── features/        # Бизнес-компоненты (CamForm, CamChart)
├── pages/               # Страницы для React Router
├── services/
│   ├── api.js          # Axios instance
│   └── camService.js   # API для кулачков
├── hooks/              # Custom hooks (опционально)
├── utils/              # Утилиты (formatters, validators)
└── App.jsx             # React Router setup

ТРЕБОВАНИЯ:
- UI компоненты переиспользуемые (Button, Input)
- Feature компоненты содержат бизнес-логику
- API calls ТОЛЬКО в services/
- Страницы используют компоненты + services

Создай базовую структуру с примерами файлов.

Claude Code: [создаёт правильную структуру]
```

---

**Следующий урок:** 2.5 Связка Backend + Frontend (разработка)
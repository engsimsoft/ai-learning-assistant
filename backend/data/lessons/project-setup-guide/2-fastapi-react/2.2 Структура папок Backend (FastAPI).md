# 2.2 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫ Backend (FastAPI)

#### üéØ –ó–∞—á–µ–º –Ω—É–∂–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

**–ü—Ä–æ–±–ª–µ–º–∞ –ø–ª–æ—Å–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:**
- –í—Å–µ —Ñ–∞–π–ª—ã –≤ –æ–¥–Ω–æ–π –ø–∞–ø–∫–µ (main.py, models.py, utils.py, helpers.py)
- –ß–µ—Ä–µ–∑ –º–µ—Å—è—Ü –Ω–µ –Ω–∞–π–¥—ë—à—å –≥–¥–µ —á—Ç–æ
- –ò–ò –ø—É—Ç–∞–µ—Ç—Å—è –≤ –∫–æ–¥–µ
- –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ —Å–º–µ—à–∞–Ω–∞ —Å HTTP –ª–æ–≥–∏–∫–æ–π
- –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Ñ–∏—á—É —Å–ª–æ–∂–Ω–æ

**–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞—ë—Ç:**
- ‚úÖ Layered Architecture (—Å–ª–æ–∏: Presentation ‚Üí Business ‚Üí Data Access)
- ‚úÖ –ü–æ–Ω—è—Ç–Ω–æ –≥–¥–µ –∏—Å–∫–∞—Ç—å –∫–æ–¥ (—Ä–æ—É—Ç–µ—Ä—ã, —Å–µ—Ä–≤–∏—Å—ã, –º–æ–¥–µ–ª–∏)
- ‚úÖ –ò–ò –ø–æ–Ω–∏–º–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É (–¥–∞—ë—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è)
- ‚úÖ –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å —Ñ–∏—á–∏ (–∑–Ω–∞–µ—à—å –∫—É–¥–∞ –∫–ª–∞—Å—Ç—å –∫–æ–¥)
- ‚úÖ –õ–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å (–∫–∞–∂–¥—ã–π —Å–ª–æ–π –æ—Ç–¥–µ–ª—å–Ω–æ)

---

#### üìê –°—Ç—Ä—É–∫—Ç—É—Ä–∞ FastAPI –ø—Ä–æ–µ–∫—Ç–∞

```
backend/
‚îÇ
‚îú‚îÄ‚îÄ app/                           # üì¶ –ì–ª–∞–≤–Ω–∞—è –ø–∞–ø–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py               # –î–µ–ª–∞–µ—Ç app/ Python –ø–∞–∫–µ—Ç–æ–º
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ main.py                   # üöÄ –¢–û–ß–ö–ê –í–•–û–î–ê
‚îÇ   ‚îÇ                              ‚Ä¢ –°–æ–∑–¥–∞–Ω–∏–µ FastAPI app
‚îÇ   ‚îÇ                              ‚Ä¢ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–æ—É—Ç–µ—Ä–æ–≤
‚îÇ   ‚îÇ                              ‚Ä¢ CORS middleware
‚îÇ   ‚îÇ                              ‚Ä¢ Startup/shutdown events
‚îÇ   ‚îÇ                              –ó–ê–ß–ï–ú: —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ routers/                  # üåê PRESENTATION LAYER
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py           
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cams.py               ‚Ä¢ API endpoints –¥–ª—è –∫—É–ª–∞—á–∫–æ–≤
‚îÇ   ‚îÇ   ‚îÇ                          ‚Ä¢ GET /api/cams
‚îÇ   ‚îÇ   ‚îÇ                          ‚Ä¢ POST /api/cams
‚îÇ   ‚îÇ   ‚îÇ                          ‚Ä¢ PUT /api/cams/{id}
‚îÇ   ‚îÇ   ‚îÇ                          –ó–ê–ß–ï–ú: —Ç–æ–ª—å–∫–æ HTTP –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ health.py             ‚Ä¢ Health check endpoints
‚îÇ   ‚îÇ                              –ó–ê–ß–ï–ú: –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã —Å–µ—Ä–≤–µ—Ä–∞
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ services/                 # üß† BUSINESS LOGIC LAYER
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ cam_service.py        ‚Ä¢ –í—Å—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ —Ä–∞—Å—á—ë—Ç–æ–≤
‚îÇ   ‚îÇ                              ‚Ä¢ –†–∞—Å—á—ë—Ç –ø—Ä–æ—Ñ–∏–ª—è –∫—É–ª–∞—á–∫–∞
‚îÇ   ‚îÇ                              ‚Ä¢ –í–∞–ª–∏–¥–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª
‚îÇ   ‚îÇ                              ‚Ä¢ –ù–ï –∑–Ω–∞–µ—Ç –ø—Ä–æ HTTP/JSON
‚îÇ   ‚îÇ                              –ó–ê–ß–ï–ú: –∏–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É, –ª–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ models/                   # üíæ DATA ACCESS LAYER (SQLAlchemy)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ cam.py                ‚Ä¢ SQLAlchemy –º–æ–¥–µ–ª–∏ –ë–î
‚îÇ   ‚îÇ                              ‚Ä¢ class Cam(Base)
‚îÇ   ‚îÇ                              –ó–ê–ß–ï–ú: —Ä–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ schemas/                  # üìã VALIDATION (Pydantic)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ cam.py                ‚Ä¢ Pydantic —Å—Ö–µ–º—ã –¥–ª—è API
‚îÇ   ‚îÇ                              ‚Ä¢ CamCreate (–≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)
‚îÇ   ‚îÇ                              ‚Ä¢ CamResponse (–≤—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)
‚îÇ   ‚îÇ                              –ó–ê–ß–ï–ú: –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö API
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ core/                     # ‚öôÔ∏è CORE (–∫–æ–Ω—Ñ–∏–≥–∏, –ë–î)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.py             ‚Ä¢ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îÇ                          ‚Ä¢ Pydantic BaseSettings
‚îÇ   ‚îÇ   ‚îÇ                          ‚Ä¢ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ .env
‚îÇ   ‚îÇ   ‚îÇ                          –ó–ê–ß–ï–ú: —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ database.py           ‚Ä¢ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
‚îÇ   ‚îÇ                              ‚Ä¢ SQLAlchemy engine, session
‚îÇ   ‚îÇ                              –ó–ê–ß–ï–ú: –µ–¥–∏–Ω–æ–µ –º–µ—Å—Ç–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ utils/                    # üîß UTILITIES (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îî‚îÄ‚îÄ helpers.py            ‚Ä¢ –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã
‚îÇ                                  ‚Ä¢ –§—É–Ω–∫—Ü–∏–∏ –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤–µ–∑–¥–µ
‚îÇ                                  –ó–ê–ß–ï–ú: –∏–∑–±–µ–∂–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ
‚îú‚îÄ‚îÄ tests/                        # üß™ –¢–ï–°–¢–´ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è –Ω–∞—á–∞–ª–∞)
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ test_routers/
‚îÇ   ‚îú‚îÄ‚îÄ test_services/
‚îÇ   ‚îî‚îÄ‚îÄ test_models/
‚îÇ
‚îú‚îÄ‚îÄ alembic/                      # üìä –ú–ò–ì–†–ê–¶–ò–ò –ë–î (–∫–æ–≥–¥–∞ –¥–æ–±–∞–≤–∏—à—å –ë–î)
‚îÇ   ‚îú‚îÄ‚îÄ versions/
‚îÇ   ‚îî‚îÄ‚îÄ env.py
‚îÇ
‚îú‚îÄ‚îÄ requirements.txt              # üì¶ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ .env                          # üîê –°–µ–∫—Ä–µ—Ç—ã (–≤ .gitignore)
‚îú‚îÄ‚îÄ .env.example                  # üìù –®–∞–±–ª–æ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ .gitignore                    # üö´ –ò—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è Git
‚îî‚îÄ‚îÄ README.md                     # üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

---

#### üí° –î–µ—Ç–∞–ª—å–Ω–æ –ø—Ä–æ –∫–∞–∂–¥—É—é –ø–∞–ø–∫—É

**app/main.py - –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞**

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –°–æ–∑–¥–∞–Ω–∏–µ FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Ä–æ—É—Ç–µ—Ä–æ–≤
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CORS
- Startup/shutdown events

**–ü—Ä–∏–º–µ—Ä:**
```python
from fastapi import FastAPI
from fastapi.middleware.cors import CORSMiddleware

from app.core.config import settings
from app.routers import cams, health

# –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
app = FastAPI(
    title=settings.APP_NAME,
    description="Backend API –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ –∫—É–ª–∞—á–∫–æ–≤",
    version="1.0.0"
)

# CORS middleware
app.add_middleware(
    CORSMiddleware,
    allow_origins=settings.CORS_ORIGINS,
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–æ—É—Ç–µ—Ä–æ–≤
app.include_router(health.router, tags=["health"])
app.include_router(cams.router, prefix="/api/cams", tags=["cams"])

# Startup event
@app.on_event("startup")
async def startup_event():
    print("üöÄ Application startup")

# Shutdown event
@app.on_event("shutdown")
async def shutdown_event():
    print("üëã Application shutdown")
```

**–ß—Ç–æ –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
- ‚ùå –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (—Ä–∞—Å—á—ë—Ç—ã, –≤–∞–ª–∏–¥–∞—Ü–∏—è)
- ‚ùå Endpoints (–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ —Ä–æ—É—Ç–µ—Ä–∞—Ö)
- ‚ùå 1000 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞

**–†–∞–∑–º–µ—Ä:** ~50-100 —Å—Ç—Ä–æ–∫ –º–∞–∫—Å–∏–º—É–º

---

**app/routers/ - Presentation Layer**

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –ü–æ–ª—É—á–∏—Ç—å HTTP –∑–∞–ø—Ä–æ—Å
- –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (Pydantic)
- –í—ã–∑–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å –¥–ª—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏
- –í–µ—Ä–Ω—É—Ç—å HTTP –æ—Ç–≤–µ—Ç

**–ü—Ä–∏–º–µ—Ä: app/routers/cams.py**
```python
from fastapi import APIRouter, Depends, HTTPException
from typing import List

from app.schemas.cam import CamCreate, CamResponse
from app.services.cam_service import CamService

router = APIRouter()

@router.post("/", response_model=CamResponse, status_code=201)
async def create_cam(
    cam_data: CamCreate,
    cam_service: CamService = Depends()
):
    """
    –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫—É–ª–∞—á–æ–∫
    
    - **base_radius**: –ë–∞–∑–æ–≤—ã–π —Ä–∞–¥–∏—É—Å (–º–º)
    - **lift**: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø–æ–¥—ä—ë–º (–º–º)
    - **duration**: –ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–≥—Ä–∞–¥—É—Å—ã)
    """
    try:
        cam = await cam_service.create_cam(cam_data)
        return cam
    except ValueError as e:
        raise HTTPException(status_code=400, detail=str(e))

@router.get("/", response_model=List[CamResponse])
async def get_all_cams(
    cam_service: CamService = Depends()
):
    """–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∫—É–ª–∞—á–∫–∏"""
    return await cam_service.get_all_cams()

@router.get("/{cam_id}", response_model=CamResponse)
async def get_cam(
    cam_id: int,
    cam_service: CamService = Depends()
):
    """–ü–æ–ª—É—á–∏—Ç—å –∫—É–ª–∞—á–æ–∫ –ø–æ ID"""
    cam = await cam_service.get_cam(cam_id)
    if not cam:
        raise HTTPException(status_code=404, detail="Cam not found")
    return cam
```

**–ß—Ç–æ –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
- ‚ùå –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (—Ä–∞—Å—á—ë—Ç—ã –ø—Ä–æ—Ñ–∏–ª—è)
- ‚ùå –ü—Ä—è–º–∞—è —Ä–∞–±–æ—Ç–∞ —Å –ë–î (session.query())
- ‚ùå –°–ª–æ–∂–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ Pydantic –∏–ª–∏ —Å–µ—Ä–≤–∏—Å–µ)

**–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞:** ~100-200 —Å—Ç—Ä–æ–∫ –¥–ª—è –æ–¥–Ω–æ–≥–æ resource (cams, users, etc.)

---

**app/services/ - Business Logic Layer**

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –í–°–Ø –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –†–∞—Å—á—ë—Ç—ã, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- –í–∞–ª–∏–¥–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª
- –†–∞–±–æ—Ç–∞ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –º–æ–¥–µ–ª—è–º–∏
- –ù–ï –∑–Ω–∞–µ—Ç –ø—Ä–æ HTTP/JSON

**–ü—Ä–∏–º–µ—Ä: app/services/cam_service.py**
```python
from typing import List, Optional
from sqlalchemy.orm import Session

from app.models.cam import Cam
from app.schemas.cam import CamCreate, CamResponse
from math import cos, sin, radians

class CamService:
    def __init__(self, db: Session):
        self.db = db
    
    async def create_cam(self, cam_data: CamCreate) -> CamResponse:
        """–°–æ–∑–¥–∞—Ç—å –∫—É–ª–∞—á–æ–∫ —Å —Ä–∞—Å—á—ë—Ç–æ–º –ø—Ä–æ—Ñ–∏–ª—è"""
        # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞: –≤–∞–ª–∏–¥–∞—Ü–∏—è
        self._validate_cam_parameters(cam_data)
        
        # –†–∞—Å—á—ë—Ç –ø—Ä–æ—Ñ–∏–ª—è
        profile = self._calculate_profile(cam_data)
        
        # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
        cam = Cam(
            base_radius=cam_data.base_radius,
            lift=cam_data.lift,
            duration=cam_data.duration,
            profile_json=profile
        )
        self.db.add(cam)
        self.db.commit()
        self.db.refresh(cam)
        
        return CamResponse.from_orm(cam)
    
    def _validate_cam_parameters(self, cam_data: CamCreate):
        """–í–∞–ª–∏–¥–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª"""
        if cam_data.base_radius <= 0:
            raise ValueError("Base radius must be positive")
        
        if cam_data.lift <= 0:
            raise ValueError("Lift must be positive")
        
        if cam_data.lift > cam_data.base_radius * 2:
            raise ValueError("Lift too large for base radius")
    
    def _calculate_profile(self, cam_data: CamCreate) -> dict:
        """–†–∞—Å—á—ë—Ç –ø—Ä–æ—Ñ–∏–ª—è –∫—É–ª–∞—á–∫–∞"""
        profile_points = []
        
        for angle in range(int(cam_data.duration)):
            radius = self._calculate_radius_at_angle(
                angle, 
                cam_data.base_radius, 
                cam_data.lift,
                cam_data.duration
            )
            
            x = radius * cos(radians(angle))
            y = radius * sin(radians(angle))
            
            profile_points.append({
                "angle": angle,
                "x": x,
                "y": y,
                "radius": radius
            })
        
        return {"points": profile_points}
    
    def _calculate_radius_at_angle(
        self, 
        angle: float, 
        base_radius: float,
        max_lift: float,
        duration: float
    ) -> float:
        """–†–∞—Å—á—ë—Ç —Ä–∞–¥–∏—É—Å–∞ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ç–æ—á–∫–µ"""
        # –£–ø—Ä–æ—â—ë–Ω–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞ (–≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ —Å–ª–æ–∂–Ω–µ–µ)
        lift_ratio = angle / duration
        current_lift = max_lift * sin(radians(lift_ratio * 180))
        return base_radius + current_lift
    
    async def get_all_cams(self) -> List[CamResponse]:
        """–ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∫—É–ª–∞—á–∫–∏"""
        cams = self.db.query(Cam).all()
        return [CamResponse.from_orm(cam) for cam in cams]
    
    async def get_cam(self, cam_id: int) -> Optional[CamResponse]:
        """–ü–æ–ª—É—á–∏—Ç—å –∫—É–ª–∞—á–æ–∫ –ø–æ ID"""
        cam = self.db.query(Cam).filter(Cam.id == cam_id).first()
        return CamResponse.from_orm(cam) if cam else None
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ:**
- ‚úÖ –í—Å—è –ª–æ–≥–∏–∫–∞ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–∞ (–ª–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å)
- ‚úÖ –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å (–∏–∑ —Ä–∞–∑–Ω—ã—Ö endpoints)
- ‚úÖ –ù–µ –∑–Ω–∞–µ—Ç –ø—Ä–æ HTTP (–º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ –≤ API)
- ‚úÖ –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è –ø–æ–¥–∑–∞–¥–∞—á (_calculate_radius_at_angle)

**–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞:** ~200-400 —Å—Ç—Ä–æ–∫ –¥–ª—è –æ–¥–Ω–æ–≥–æ service

---

**app/models/ - Data Access Layer (SQLAlchemy)**

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –ú–æ–¥–µ–ª–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î
- –¢–æ–ª—å–∫–æ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü –∏ —Å–≤—è–∑–µ–π
- –ù–ï —Å–æ–¥–µ—Ä–∂–∏—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É

**–ü—Ä–∏–º–µ—Ä: app/models/cam.py**
```python
from sqlalchemy import Column, Integer, Float, String, JSON, DateTime
from sqlalchemy.sql import func
from app.core.database import Base

class Cam(Base):
    __tablename__ = "cams"
    
    id = Column(Integer, primary_key=True, index=True)
    base_radius = Column(Float, nullable=False)
    lift = Column(Float, nullable=False)
    duration = Column(Float, nullable=False)
    profile_json = Column(JSON, nullable=True)
    
    created_at = Column(DateTime(timezone=True), server_default=func.now())
    updated_at = Column(DateTime(timezone=True), onupdate=func.now())
    
    def __repr__(self):
        return f"<Cam(id={self.id}, base_radius={self.base_radius})>"
```

**–ß—Ç–æ –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
- ‚ùå –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (—Ä–∞—Å—á—ë—Ç—ã)
- ‚ùå –í–∞–ª–∏–¥–∞—Ü–∏—è (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ Pydantic –∏–ª–∏ —Å–µ—Ä–≤–∏—Å–µ)
- ‚ùå –ú–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞—Å—á—ë—Ç–æ–≤

**–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞:** ~50-100 —Å—Ç—Ä–æ–∫ –Ω–∞ –º–æ–¥–µ–ª—å

---

**app/schemas/ - Validation (Pydantic)**

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö API
- –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –¢–∏–ø–∏–∑–∞—Ü–∏—è

**–ü—Ä–∏–º–µ—Ä: app/schemas/cam.py**
```python
from pydantic import BaseModel, Field
from typing import Optional
from datetime import datetime

class CamBase(BaseModel):
    """–ë–∞–∑–æ–≤—ã–µ –ø–æ–ª—è –∫—É–ª–∞—á–∫–∞"""
    base_radius: float = Field(gt=0, description="–ë–∞–∑–æ–≤—ã–π —Ä–∞–¥–∏—É—Å (–º–º)")
    lift: float = Field(gt=0, description="–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø–æ–¥—ä—ë–º (–º–º)")
    duration: float = Field(ge=0, le=360, description="–ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–≥—Ä–∞–¥—É—Å—ã)")

class CamCreate(CamBase):
    """–°—Ö–µ–º–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫—É–ª–∞—á–∫–∞"""
    pass

class CamUpdate(BaseModel):
    """–°—Ö–µ–º–∞ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫—É–ª–∞—á–∫–∞"""
    base_radius: Optional[float] = Field(None, gt=0)
    lift: Optional[float] = Field(None, gt=0)
    duration: Optional[float] = Field(None, ge=0, le=360)

class CamResponse(CamBase):
    """–°—Ö–µ–º–∞ –æ—Ç–≤–µ—Ç–∞ API"""
    id: int
    profile_json: Optional[dict] = None
    created_at: datetime
    updated_at: Optional[datetime] = None
    
    class Config:
        from_attributes = True  # –î–ª—è —Ä–∞–±–æ—Ç—ã —Å SQLAlchemy
```

**–ó–∞—á–µ–º –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å—Ö–µ–º—ã:**
- `CamBase` - –æ–±—â–∏–µ –ø–æ–ª—è
- `CamCreate` - –¥–ª—è POST (—Å–æ–∑–¥–∞–Ω–∏–µ)
- `CamUpdate` - –¥–ª—è PUT/PATCH (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ, –≤—Å–µ –ø–æ–ª—è optional)
- `CamResponse` - –¥–ª—è –æ—Ç–≤–µ—Ç–∞ API (—Å id, timestamps)

**–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞:** ~50-150 —Å—Ç—Ä–æ–∫ –¥–ª—è –æ–¥–Ω–æ–≥–æ resource

---

**app/core/ - Core –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**

**app/core/config.py - –ù–∞—Å—Ç—Ä–æ–π–∫–∏**

```python
from pydantic_settings import BaseSettings
from typing import List

class Settings(BaseSettings):
    """–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏–∑ .env"""
    
    # App
    APP_NAME: str = "FastAPI Backend"
    VERSION: str = "1.0.0"
    API_PREFIX: str = "/api"
    
    # CORS
    CORS_ORIGINS: List[str] = ["http://localhost:5173"]
    
    # Database
    DATABASE_URL: str = "sqlite:///./app.db"
    
    # Security (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
    SECRET_KEY: str
    
    class Config:
        env_file = ".env"
        case_sensitive = True

settings = Settings()
```

**app/core/database.py - –ë–î –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ**

```python
from sqlalchemy import create_engine
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.orm import sessionmaker

from app.core.config import settings

# Engine
engine = create_engine(
    settings.DATABASE_URL,
    connect_args={"check_same_thread": False}  # –î–ª—è SQLite
)

# Session factory
SessionLocal = sessionmaker(autocommit=False, autoflush=False, bind=engine)

# Base –¥–ª—è –º–æ–¥–µ–ª–µ–π
Base = declarative_base()

# Dependency –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è DB session
def get_db():
    db = SessionLocal()
    try:
        yield db
    finally:
        db.close()
```

---

**app/utils/ - –£—Ç–∏–ª–∏—Ç—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)**

**–ö–æ–≥–¥–∞ –Ω—É–∂–Ω—ã:**
- –§—É–Ω–∫—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö
- –ù–µ –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —Å–µ—Ä–≤–∏—Å—É

**–ü—Ä–∏–º–µ—Ä:**
```python
# app/utils/helpers.py
from datetime import datetime

def format_timestamp(dt: datetime) -> str:
    """–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ timestamp"""
    return dt.strftime("%Y-%m-%d %H:%M:%S")

def validate_positive(value: float, field_name: str) -> None:
    """–í–∞–ª–∏–¥–∞—Ü–∏—è —á—Ç–æ —á–∏—Å–ª–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ"""
    if value <= 0:
        raise ValueError(f"{field_name} must be positive")
```

**‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ:** –ù–µ –¥–µ–ª–∞–π `utils/` —Å–≤–∞–ª–∫–æ–π! –ï—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —Å–µ—Ä–≤–∏—Å—É ‚Üí –≤ —Å–µ—Ä–≤–∏—Å.

---

#### üîÑ –ö–∞–∫ —Å–ª–æ–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç

```
HTTP Request
    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  ROUTERS (Presentation Layer)           ‚îÇ
‚îÇ  ‚Ä¢ –ü–æ–ª—É—á–∞–µ—Ç HTTP –∑–∞–ø—Ä–æ—Å                 ‚îÇ
‚îÇ  ‚Ä¢ –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ (Pydantic)         ‚îÇ
‚îÇ  ‚Ä¢ –í—ã–∑—ã–≤–∞–µ—Ç Service                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  SERVICES (Business Logic Layer)        ‚îÇ
‚îÇ  ‚Ä¢ –í—ã–ø–æ–ª–Ω—è–µ—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É              ‚îÇ
‚îÇ  ‚Ä¢ –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞            ‚îÇ
‚îÇ  ‚Ä¢ –†–∞–±–æ—Ç–∞–µ—Ç —Å Models                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  MODELS (Data Access Layer)             ‚îÇ
‚îÇ  ‚Ä¢ –†–∞–±–æ—Ç–∞–µ—Ç —Å –ë–î                        ‚îÇ
‚îÇ  ‚Ä¢ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚Üì
              Database
                  ‚Üì
              Response
```

**–í–∞–∂–Ω–æ:** –°–ª–æ–∏ –æ–±—â–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å —Å–æ—Å–µ–¥–Ω–∏–º–∏!
- Router ‚Üí Service (‚úÖ)
- Service ‚Üí Model (‚úÖ)
- Router ‚Üí Model (‚ùå –º–∏–Ω—É—è Service)

---

#### ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

**–§–∞–π–ª—ã –∏ –ø–∞–ø–∫–∏:**
- [ ] app/main.py —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (~50-100 —Å—Ç—Ä–æ–∫)
- [ ] app/routers/ —Å–æ–∑–¥–∞–Ω–∞ (–ø–æ —Ñ–∞–π–ª—É –Ω–∞ resource)
- [ ] app/services/ —Å–æ–∑–¥–∞–Ω–∞ (–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞)
- [ ] app/models/ —Å–æ–∑–¥–∞–Ω–∞ (SQLAlchemy)
- [ ] app/schemas/ —Å–æ–∑–¥–∞–Ω–∞ (Pydantic)
- [ ] app/core/ —Å–æ–∑–¥–∞–Ω–∞ (config.py, database.py)

**–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏:**
- [ ] –†–æ—É—Ç–µ—Ä—ã —Ç–æ–ª—å–∫–æ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è (<200 —Å—Ç—Ä–æ–∫ –Ω–∞ —Ñ–∞–π–ª)
- [ ] –°–µ—Ä–≤–∏—Å—ã —Å–æ–¥–µ—Ä–∂–∞—Ç –≤—Å—é –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É
- [ ] –ú–æ–¥–µ–ª–∏ —Ç–æ–ª—å–∫–æ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
- [ ] –ù–µ—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ –≤ —Ä–æ—É—Ç–µ—Ä–∞—Ö
- [ ] –ù–µ—Ç HTTP –ª–æ–≥–∏–∫–∏ –≤ —Å–µ—Ä–≤–∏—Å–∞—Ö

**–ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ:**
- [ ] –§–∞–π–ª—ã –Ω–∞–∑–≤–∞–Ω—ã –ø–æ resource (cams.py, users.py)
- [ ] –ö–ª–∞—Å—Å—ã —Å–µ—Ä–≤–∏—Å–æ–≤: CamService, UserService
- [ ] –°—Ö–µ–º—ã: CamCreate, CamResponse

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –ò–ò:**
- [ ] Claude Code –ø–æ–Ω–∏–º–∞–µ—Ç –≥–¥–µ —á—Ç–æ –∏—Å–∫–∞—Ç—å
- [ ] –ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ "–¥–æ–±–∞–≤—å endpoint" ‚Üí –¥–æ–±–∞–≤–ª—è–µ—Ç –≤ router
- [ ] –ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ "–¥–æ–±–∞–≤—å —Ä–∞—Å—á—ë—Ç" ‚Üí –¥–æ–±–∞–≤–ª—è–µ—Ç –≤ service

---

#### ü§ñ –î–∏–∞–ª–æ–≥ —Å Claude Code

**‚úÖ –•–æ—Ä–æ—à–∏–π –¥–∏–∞–ª–æ–≥ (—Å–æ–∑–¥–∞–Ω–∏–µ structure):**
```
–¢—ã: –°–æ–∑–¥–∞–π —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è FastAPI –ø—Ä–æ–µ–∫—Ç–∞ —Å–ª–µ–¥—É—è Layered Architecture.

–°–¢–†–£–ö–¢–£–†–ê:
app/
‚îú‚îÄ‚îÄ main.py              # FastAPI app, —Ä–æ—É—Ç–µ—Ä—ã, CORS
‚îú‚îÄ‚îÄ routers/
‚îÇ   ‚îú‚îÄ‚îÄ cams.py         # Endpoints –¥–ª—è –∫—É–ª–∞—á–∫–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ health.py       # Health check
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îî‚îÄ‚îÄ cam_service.py  # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ —Ä–∞—Å—á—ë—Ç–æ–≤
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îî‚îÄ‚îÄ cam.py          # SQLAlchemy –º–æ–¥–µ–ª—å
‚îú‚îÄ‚îÄ schemas/
‚îÇ   ‚îî‚îÄ‚îÄ cam.py          # Pydantic —Å—Ö–µ–º—ã
‚îî‚îÄ‚îÄ core/
    ‚îú‚îÄ‚îÄ config.py       # Settings –∏–∑ .env
    ‚îî‚îÄ‚îÄ database.py     # DB connection

–¢–†–ï–ë–û–í–ê–ù–ò–Ø:
- –†–æ—É—Ç–µ—Ä—ã –¢–û–õ–¨–ö–û –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è (<200 —Å—Ç—Ä–æ–∫)
- –°–µ—Ä–≤–∏—Å—ã –í–°–Ø –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
- –ú–æ–¥–µ–ª–∏ —Ç–æ–ª—å–∫–æ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
- –°–ª–µ–¥—É–π –ø—Ä–∏–Ω—Ü–∏–ø—É: Router ‚Üí Service ‚Üí Model

Claude Code: [—Å–æ–∑–¥–∞—ë—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É]
```

---

**–°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–∫:** 2.3 –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Frontend (React + Vite)